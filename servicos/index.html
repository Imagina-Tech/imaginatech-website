<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel de Serviços - ImaginaTech Admin</title>
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="Painel administrativo de serviços - ImaginaTech">
    <meta name="robots" content="noindex, nofollow">
    
    <!-- Favicons -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700;900&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    
    <!-- CSS Principal -->
    <link rel="stylesheet" href="styles-servicos.css">
</head>
<body>
    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <div class="loading-text">Conectando ao servidor...</div>
        </div>
    </div>

    <!-- Background Effects -->
    <div class="cosmic-bg">
        <div class="grid-lines"></div>
        <div class="particles" id="particles"></div>
    </div>

    <!-- Login Screen (Admin Only) -->
    <div class="login-screen hidden" id="loginScreen">
        <div class="login-container">
            <div class="login-header">
                <div class="login-logo">
                    <h1>ImaginaTech</h1>
                    <p>Painel Administrativo</p>
                </div>
                <div class="login-info">
                    <i class="fas fa-shield-alt"></i>
                    <h2>Acesso Restrito</h2>
                    <p>Área exclusiva para funcionários autorizados</p>
                </div>
            </div>

            <button class="btn-google" onclick="signInWithGoogle()">
                <i class="fab fa-google"></i>
                <span>Entrar com Google</span>
            </button>

            <div class="login-footer">
                <a href="/acompanhar-pedido" class="client-link">
                    <i class="fas fa-users"></i>
                    Área do Cliente
                </a>
            </div>
        </div>
    </div>

    <!-- Admin Dashboard -->
    <div class="admin-dashboard hidden" id="adminDashboard">
        <!-- Header -->
        <header class="navbar">
            <div class="navbar-container">
                <div class="navbar-left">
                    <div class="logo-section">
                        <h1 class="logo">ImaginaTech</h1>
                        <span class="logo-subtitle">Painel de Serviços</span>
                    </div>
                    
                    <div class="connection-status" id="connectionStatus">
                        <div class="status-dot"></div>
                        <span id="statusText">Conectado</span>
                    </div>
                </div>

                <div class="navbar-right">
                    <div class="user-info" id="userInfo">
                        <img id="userPhoto" class="user-photo" alt="Foto" src="/assets/default-avatar.png">
                        <div class="user-details">
                            <span class="user-name" id="userName">Carregando...</span>
                            <span class="user-role">Administrador</span>
                        </div>
                    </div>
                    
                    <button class="btn-logout" onclick="signOut()">
                        <i class="fas fa-sign-out-alt"></i>
                        <span class="btn-text">Sair</span>
                    </button>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <div class="container">
                <!-- Action Bar -->
                <div class="action-bar">
                    <h2 class="page-title">
                        <i class="fas fa-tasks"></i>
                        Gerenciamento de Serviços
                    </h2>
                    <div class="action-buttons">
                        <button class="btn-primary" onclick="openAddModal()">
                            <i class="fas fa-plus"></i>
                            Novo Serviço
                        </button>
                        <a href="/acompanhar-pedido" target="_blank" class="btn-secondary">
                            <i class="fas fa-external-link-alt"></i>
                            Portal do Cliente
                        </a>
                    </div>
                </div>

                <!-- Statistics Cards -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #667eea, #764ba2);">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-number" id="stat-total">0</div>
                            <div class="stat-label">Total de Serviços</div>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #f093fb, #f5576c);">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-number" id="stat-pending">0</div>
                            <div class="stat-label">Pendentes</div>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #4facfe, #00f2fe);">
                            <i class="fas fa-cogs"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-number" id="stat-production">0</div>
                            <div class="stat-label">Em Produção</div>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #43e97b, #38f9d7);">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-number" id="stat-completed">0</div>
                            <div class="stat-label">Concluídos</div>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #fa709a, #fee140);">
                            <i class="fas fa-box-open"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-number" id="stat-ready">0</div>
                            <div class="stat-label">Para Retirada</div>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #30cfd0, #330867);">
                            <i class="fas fa-handshake"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-number" id="stat-delivered">0</div>
                            <div class="stat-label">Entregues</div>
                        </div>
                    </div>
                </div>

                <!-- Filter Bar -->
                <div class="filter-bar">
                    <div class="filter-buttons">
                        <button class="btn-filter active" onclick="filterServices('todos')">
                            <i class="fas fa-list"></i>
                            <span>Todos</span>
                        </button>
                        <button class="btn-filter" onclick="filterServices('pendente')">
                            <i class="fas fa-clock"></i>
                            <span>Pendentes</span>
                        </button>
                        <button class="btn-filter" onclick="filterServices('producao')">
                            <i class="fas fa-cogs"></i>
                            <span>Em Produção</span>
                        </button>
                        <button class="btn-filter" onclick="filterServices('concluido')">
                            <i class="fas fa-check-circle"></i>
                            <span>Concluídos</span>
                        </button>
                        <button class="btn-filter" onclick="filterServices('retirada')">
                            <i class="fas fa-box-open"></i>
                            <span>Retirada</span>
                        </button>
                        <button class="btn-filter" onclick="filterServices('entregue')">
                            <i class="fas fa-handshake"></i>
                            <span>Entregues</span>
                        </button>
                    </div>
                    
                    <div class="search-box">
                        <i class="fas fa-search"></i>
                        <input type="text" id="searchInput" placeholder="Buscar por nome, cliente ou código..." onkeyup="searchServices()">
                    </div>
                </div>

                <!-- Services Grid -->
                <div class="services-grid" id="servicesGrid">
                    <!-- Service cards will be added here dynamically -->
                </div>

                <!-- Empty State -->
                <div class="empty-state" id="emptyState">
                    <div class="empty-icon">
                        <i class="fas fa-inbox"></i>
                    </div>
                    <h3>Nenhum serviço encontrado</h3>
                    <p id="emptyText">Clique no botão abaixo para adicionar seu primeiro serviço</p>
                    <button class="btn-primary" id="emptyAddBtn" onclick="openAddModal()">
                        <i class="fas fa-plus"></i>
                        Adicionar Serviço
                    </button>
                </div>
            </div>
        </main>
    </div>

    <!-- Service Modal -->
    <div class="modal" id="serviceModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">Novo Serviço</h2>
                <button class="modal-close" onclick="closeModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <form id="serviceForm" onsubmit="saveService(event)">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="serviceName">
                            <i class="fas fa-cube"></i>
                            Nome do Serviço *
                        </label>
                        <input type="text" id="serviceName" required autocomplete="off">
                    </div>

                    <div class="form-group">
                        <label for="clientName">
                            <i class="fas fa-user"></i>
                            Nome do Cliente *
                        </label>
                        <input type="text" id="clientName" required autocomplete="off">
                    </div>

                    <div class="form-group">
                        <label for="clientPhone">
                            <i class="fas fa-phone"></i>
                            WhatsApp do Cliente
                        </label>
                        <input type="tel" id="clientPhone" placeholder="(11) 99999-9999" autocomplete="off">
                    </div>

                    <div class="form-group">
                        <label for="serviceMaterial">
                            <i class="fas fa-layer-group"></i>
                            Material *
                        </label>
                        <select id="serviceMaterial" required>
                            <option value="">Selecione o material</option>
                            <option value="PLA">PLA</option>
                            <option value="ABS">ABS</option>
                            <option value="PETG">PETG</option>
                            <option value="TPU">TPU</option>
                            <option value="Resina">Resina</option>
                            <option value="Outros">Outros</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="serviceColor">
                            <i class="fas fa-palette"></i>
                            Cor
                        </label>
                        <select id="serviceColor">
                            <option value="">Selecione a cor</option>
                            <option value="preto">Preto</option>
                            <option value="branco">Branco</option>
                            <option value="vermelho">Vermelho</option>
                            <option value="azul">Azul</option>
                            <option value="verde">Verde</option>
                            <option value="amarelo">Amarelo</option>
                            <option value="laranja">Laranja</option>
                            <option value="roxo">Roxo</option>
                            <option value="outros">Outras</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="servicePriority">
                            <i class="fas fa-flag"></i>
                            Prioridade *
                        </label>
                        <select id="servicePriority" required>
                            <option value="baixa">Baixa</option>
                            <option value="media" selected>Média</option>
                            <option value="alta">Alta</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="startDate">
                            <i class="fas fa-calendar-plus"></i>
                            Data de Início *
                        </label>
                        <input type="date" id="startDate" required>
                    </div>

                    <div class="form-group">
                        <label for="dueDate">
                            <i class="fas fa-calendar-check"></i>
                            Prazo de Entrega *
                        </label>
                        <input type="date" id="dueDate" required>
                    </div>

                    <div class="form-group">
                        <label for="serviceValue">
                            <i class="fas fa-dollar-sign"></i>
                            Valor (R$)
                        </label>
                        <input type="number" id="serviceValue" step="0.01" min="0" placeholder="0,00">
                    </div>

                    <div class="form-group full-width">
                        <label for="serviceDescription">
                            <i class="fas fa-align-left"></i>
                            Descrição do Serviço
                        </label>
                        <textarea id="serviceDescription" rows="3" placeholder="Detalhes sobre o serviço..." autocomplete="off"></textarea>
                    </div>

                    <div class="form-group full-width">
                        <label for="serviceObservations">
                            <i class="fas fa-exclamation-triangle"></i>
                            Observações
                        </label>
                        <textarea id="serviceObservations" rows="2" placeholder="Observações importantes..." autocomplete="off"></textarea>
                    </div>
                </div>

                <input type="hidden" id="serviceId">
                <input type="hidden" id="serviceStatus" value="pendente">

                <div class="modal-footer">
                    <button type="button" class="btn-cancel" onclick="closeModal()">
                        <i class="fas fa-times"></i>
                        Cancelar
                    </button>
                    <button type="submit" class="btn-save">
                        <i class="fas fa-save"></i>
                        <span id="saveButtonText">Salvar Serviço</span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Status Confirmation Modal -->
    <div class="modal" id="statusModal">
        <div class="modal-content modal-small">
            <div class="modal-header">
                <h2>Confirmar Mudança de Status</h2>
                <button class="modal-close" onclick="closeStatusModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="modal-body">
                <p id="statusModalMessage">Deseja alterar o status deste serviço?</p>
                
                <div class="whatsapp-option" id="whatsappOption" style="display: none;">
                    <label class="checkbox-label">
                        <input type="checkbox" id="sendWhatsappNotification">
                        <span>Notificar cliente via WhatsApp</span>
                    </label>
                </div>
            </div>
            
            <div class="modal-footer">
                <button class="btn-cancel" onclick="closeStatusModal()">
                    <i class="fas fa-times"></i>
                    Cancelar
                </button>
                <button class="btn-confirm" onclick="confirmStatusChange()">
                    <i class="fas fa-check"></i>
                    Confirmar
                </button>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>

    <!-- JavaScript Principal -->
    <script src="script-servicos.js"></script>
    
    <!-- Particles Animation -->
    <script>
        // Create animated particles
        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            if (!particlesContainer) return;
            
            const particleCount = window.innerWidth < 768 ? 15 : 30;
            
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 20 + 's';
                particle.style.animationDuration = (20 + Math.random() * 10) + 's';
                particlesContainer.appendChild(particle);
            }
        }
        
        // Initialize on load
        window.addEventListener('DOMContentLoaded', createParticles);
    </script>
</body>
</html>
